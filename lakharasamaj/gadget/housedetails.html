<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Animated Table with Export</title>

<!-- Libraries for Export -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:sans-serif;}
html,body{height:100%;width:100%;}
body{display:flex;justify-content:center;align-items:center;background:transparent;}
main.table{width:100%;height:100%;background:#fff5;backdrop-filter:blur(7px);border-radius:.8rem;overflow:hidden;display:flex;flex-direction:column;}
.table__header{width:100%;padding:.5rem 1rem;display:flex;justify-content:space-between;align-items:center;background:#fff4;border-radius:.5rem;}
.table__header h1{font-size:1rem;}
.table__header .input-group{width:30%;background:#fff5;border-radius:2rem;display:flex;align-items:center;padding:0 .8rem;transition:.2s;}
.table__header .input-group:hover{width:40%;background:#fff8;}
.table__header .input-group img{width:1.2rem;height:1.2rem;}
.table__header .input-group input{width:100%;border:none;outline:none;background:transparent;padding:0 .3rem;}
.table__body{flex:1;margin:.5rem 0;overflow:auto;background:#fffb;border-radius:.6rem;}
table{width:100%;border-collapse:collapse;}
th,td{padding:.8rem;text-align:left;}
td img{width:36px;height:36px;margin-right:.5rem;border-radius:50%;vertical-align:middle;}
thead th{position:sticky;top:0;background:#a5d098fe;cursor:pointer;}
tbody tr:nth-child(even){background-color:#0000000b;}
tbody tr:hover{background-color:#fff6 !important;}

/* Animation */
tbody tr{--delay:.1s;transition:.5s ease-in-out var(--delay),background-color 0s;}
tbody tr.hide{opacity:0;transform:translateX(100%);}
tbody tr td,tbody tr td p,tbody tr td img{transition:.2s ease-in-out;}
tbody tr.hide td,tbody tr.hide td p{padding:0;font:0/0 sans-serif;transition:.2s ease-in-out .5s;}
tbody tr.hide td img{width:0;height:0;transition:.2s ease-in-out .5s;}

.status{padding:.4rem 0;border-radius:2rem;text-align:center;}
.status.delivered{background-color:#86e49d;color:#006b21;}
.status.cancelled{background-color:#d893a3;color:#b30021;}
.status.pending{background-color:#ebc474;}
.status.shipped{background-color:#6fcaea;}

/* Export */
.export__file{position:relative;}
.export__file-btn{display:inline-block;width:2rem;height:2rem;background:#fff6;border-radius:50%;cursor:pointer;}
.export__file-options{position:absolute;right:0;top:2.2rem;width:12rem;background:#f2f2f2;border-radius:.5rem;text-align:center;opacity:0;transform:scale(.8);transform-origin:top right;transition:.2s;}
.export__file input:checked + .export__file-options{opacity:1;transform:scale(1);z-index:100;}
.export__file-options label{display:flex;justify-content:space-around;align-items:center;padding:.6rem 0;transition:.2s;cursor:pointer;}
.export__file-options label:first-of-type{font-weight:bold;}
.export__file-options img{width:2rem;height:auto;}
.export__file .export__file-btn {display: inline-block; width: 2rem; height: 2rem;background: #fff6 url(https://jahid6292.github.io/aetmyweb/lakharasamaj/images/export.png) center / 80% no-repeat;    border-radius: 50%;    transition: .2s ease-in-out;}
.export__file #export-file {display: none;}
</style>
</head>
<body>
<main class="table">
<section class="table__header">
<h1>House Details</h1>
<div class="input-group">
<input type="search" placeholder="Search Data...">
<img src="https://jahid6292.github.io/aetmyweb/lakharasamaj/images/search.png" alt="">
</div>
<div class="export__file">
<label for="export-file" class="export__file-btn" title="Export File"></label>
<input type="checkbox" id="export-file">
<div class="export__file-options">
<label>Export As â†’</label>
<label for="export-file" id="toPDF">PDF <img src="https://jahid6292.github.io/aetmyweb/lakharasamaj/images/pdf.png"></label>
<label for="export-file" id="toJSON">JSON <img src="https://jahid6292.github.io/aetmyweb/lakharasamaj/images/json.png"></label>
<label for="export-file" id="toCSV">CSV <img src="https://jahid6292.github.io/aetmyweb/lakharasamaj/images/csv.png"></label>
<label for="export-file" id="toEXCEL">EXCEL <img src="https://jahid6292.github.io/aetmyweb/lakharasamaj/images/excel.png"></label>
</div>
</div>
</section>
<section class="table__body">
<table>
<thead>
<tr>
<th>Id</th>
<th>Customer</th>
<th>Location</th>
<th>Order Date</th>
<th>Status</th>
<th>Amount</th>
</tr>
</thead>
<tbody>

</tbody>
</table>
</section>
</main>
       <script>
// DYNAMIC DATA
const orders=[
{id:1, customer:"Zinzu Chan Lee", image:"images/Zinzu Chan Lee.jpg", location:"Seoul", orderDate:"17 Dec, 2022", status:"Delivered", amount:"$128.90"},
{id:2, customer:"Jeet Saru", image:"images/Jeet Saru.jpg", location:"Kathmandu", orderDate:"27 Aug, 2023", status:"Cancelled", amount:"$5350.50"},
{id:3, customer:"Sonal Gharti", image:"images/Sonal Gharti.jpg", location:"Tokyo", orderDate:"14 Mar, 2023", status:"Shipped", amount:"$210.40"}
];
const tbody=document.querySelector('tbody');
function generateRows(){
    tbody.innerHTML='';
    orders.forEach((order,i)=>{
        const tr=document.createElement('tr');
        tr.style.setProperty('--delay',i/25+'s');
        tr.innerHTML=`
        <td>${order.id}</td>
        <td><img src="${order.image}" alt=""> ${order.customer}</td>
        <td>${order.location}</td>
        <td>${order.orderDate}</td>
        <td><p class="status ${order.status.toLowerCase()}">${order.status}</p></td>
        <td><strong>${order.amount}</strong></td>`;
        tbody.appendChild(tr);
    });
}
generateRows();

// SEARCH animation
const search=document.querySelector('.input-group input');
search.addEventListener('input',()=>{
    const val=search.value.toLowerCase();
    const rows=document.querySelectorAll('tbody tr');
    rows.forEach((row,i)=>{
        const text=row.textContent.toLowerCase();
        row.classList.toggle('hide', !text.includes(val));
        row.style.setProperty('--delay',i/25+'s');
    });
});

// SORT
document.querySelectorAll('thead th').forEach((th,i)=>{
    let asc=true;
    th.addEventListener('click',()=>{
        const rows=[...tbody.querySelectorAll('tr')];
        rows.sort((a,b)=>{
            const aText=a.querySelectorAll('td')[i].textContent.toLowerCase();
            const bText=b.querySelectorAll('td')[i].textContent.toLowerCase();
            return asc ? aText.localeCompare(bText) : bText.localeCompare(aText);
        });
        rows.forEach(r=>tbody.appendChild(r));
        asc=!asc;
    });
});

// PDF Export using jsPDF + html2canvas
document.querySelector('#toPDF').onclick=async()=>{
    const { jsPDF } = window.jspdf;
    const doc=new jsPDF('p','pt','a4');
    const table=document.querySelector('main.table');
    const canvas=await html2canvas(table, {scale:2});
    const imgData=canvas.toDataURL('image/png');
    const imgProps=doc.getImageProperties(imgData);
    const pdfWidth=doc.internal.pageSize.getWidth();
    const pdfHeight=(imgProps.height*pdfWidth)/imgProps.width;
    doc.addImage(imgData,'PNG',0,0,pdfWidth,pdfHeight);
    doc.save("customers.pdf");
};

// JSON Export
document.querySelector('#toJSON').onclick=()=>{
    const heads=[...document.querySelectorAll('thead th')].map(th=>th.textContent.trim());
    const data=[...document.querySelectorAll('tbody tr')].map(tr=>{
        const obj={};
        tr.querySelectorAll('td').forEach((td,i)=>obj[heads[i]]=td.textContent.trim());
        return obj;
    });
    const a=document.createElement('a');
    a.href='data:application/json;charset=utf-8,'+encodeURIComponent(JSON.stringify(data,null,2));
    a.download='customers.json';
    document.body.appendChild(a);a.click();a.remove();
};

// CSV Export
document.querySelector('#toCSV').onclick=()=>{
    const heads=[...document.querySelectorAll('thead th')].map(th=>th.textContent.trim()).join(',');
    const rows=[...document.querySelectorAll('tbody tr')].map(tr=>{
        return [...tr.querySelectorAll('td')].map(td=>td.textContent.trim().replace(/,/g,'.')).join(',');
    }).join('\n');
    const a=document.createElement('a');
    a.href='data:text/csv;charset=utf-8,'+encodeURIComponent(heads+'\n'+rows);
    a.download='customers.csv';
    document.body.appendChild(a);a.click();a.remove();
};

// Excel Export using SheetJS
document.querySelector('#toEXCEL').onclick=()=>{
    const ws_data=[];
    const headers=[...document.querySelectorAll('thead th')].map(th=>th.textContent.trim());
    ws_data.push(headers);
    document.querySelectorAll('tbody tr').forEach(tr=>{
        ws_data.push([...tr.querySelectorAll('td')].map(td=>td.textContent.trim()));
    });
    const ws=XLSX.utils.aoa_to_sheet(ws_data);
    const wb=XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb,ws,"Customers");
    XLSX.writeFile(wb,"customers.xlsx");
};
</script>
</body>
</html>
