<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ЁЯТ░ Donation Form</title>
<style>
body {
  font-family: "Segoe UI", sans-serif;
  background: linear-gradient(135deg, #f0f4ff, #e8ecf8);
  margin: 0; padding: 20px;
}
.container {
  max-width: 750px;
  margin: auto;
  background: white;
  padding: 25px;
  border-radius: 12px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
h2 { text-align: center; color: #007bff; margin-bottom: 10px; }
p.info { text-align: center; color: #444; font-size: 14px; margin-top: 0; }

.instruction {
  background: #f8fbff;
  border-left: 4px solid #007bff;
  padding: 10px 15px;
  border-radius: 8px;
  color: #333;
  margin: 15px 0;
  font-size: 14px;
  line-height: 1.6;
}

form { margin-top: 20px; }
input, select {
  width: 100%; padding: 10px; margin: 8px 0;
  border: 1px solid #ccc; border-radius: 6px;
  font-size: 15px;
}
button {
  background: #007bff; color: white; border: none;
  padding: 10px 20px; cursor: pointer; border-radius: 6px;
  font-size: 16px; transition: 0.3s;
}
button:hover { background: #0056b3; }

.progress-bar {
  display: none;
  width: 100%; background: #eee; border-radius: 6px;
  overflow: hidden; margin: 10px 0;
}
.progress {
  height: 8px; width: 0%; background: #007bff; transition: width 0.3s;
}

.qr-section {
  text-align: center; margin: 15px 0;
}
.qr-section img {
  width: 160px; height: 160px; border: 2px solid #007bff; border-radius: 8px;
}
.qr-section p { font-size: 14px; color: #333; }

table {
  width: 100%; margin-top: 25px; border-collapse: collapse; background: white;
}
th, td {
  border: 1px solid #ddd; padding: 10px; text-align: center;
  font-size: 14px;
}
th {
  background: #007bff; color: white;
  position: sticky; top: 0;
}
img.qr-thumb { width: 50px; height: 50px; border-radius: 6px; }

@media(max-width:600px){
  th, td { font-size: 13px; padding: 8px; }
  .qr-section img { width: 120px; height: 120px; }
}
.table-wrapper {
  width: 100%;
  overflow-x: auto;
  border-radius: 8px;
}

</style>
</head>
<body>
<div class="container">
  <h2>ЁЯТ░ рджрд╛рди рдХрд░реЗрдВ (Donate Now)</h2>
  <p class="info">рдХреГрдкрдпрд╛ рдиреАрдЪреЗ рджреА рдЧрдИ рдЬрд╛рдирдХрд╛рд░реА рд╕рд╣реА-рд╕рд╣реА рднрд░реЗрдВ рдФрд░ QR рд╕реНрдХреИрди рдХрд░рдХреЗ рджрд╛рди рднреЗрдЬреЗрдВред</p>

  <div class="qr-section">
    <img src="https://jahid6292.github.io/aetmyweb/lakharasamaj/QR.webp" alt="QR Code">
    <p>ЁЯУ╕ рдиреАрдЪреЗ QR рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ (рдпрджрд┐ рдСрдирд▓рд╛рдЗрди рднреБрдЧрддрд╛рди рдХрд┐рдпрд╛ рд╣реИ)</p>
  </div>

  <div class="instruction">
    ЁЯкФ <b>рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реВрдЪрдирд╛:</b><br>
    рдЖрдк рдЕрдкрдиреЗ рджрд╛рди рдХрд╛ <b>рд╕реНрдЯреЗрдЯрд╕</b> рдиреАрдЪреЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред  
    рд╢реБрд░реВ рдореЗрдВ рдпрд╣ <b>Pending</b> рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ред рдмреИрдВрдХ рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ рд╕реЗ рдорд┐рд▓рд╛рди рдФрд░ рд░рд╕реАрдж рдирдВрдмрд░ рд╕рддреНрдпрд╛рдкрди рдХреЗ рдмрд╛рдж  
    рдЖрдкрдХрд╛ рд╕реНрдЯреЗрдЯрд╕ <b style="color:green;">Verified</b> рджрд┐рдЦреЗрдЧрд╛ред  
    рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реЛрдЧрд╛ рдХрд┐ рдЖрдкрдХрд╛ рджрд╛рди рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкрд╣реБрдБрдЪ рдЧрдпрд╛ рд╣реИ ЁЯЩП  
    рдпрджрд┐ рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рдХреА рд╕рдорд╕реНрдпрд╛ рдЖрдП, рддреЛ рдХреГрдкрдпрд╛ рд╣рдорд╛рд░реЗ рд╕рджрд╕реНрдпреЛрдВ рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░реЗрдВред  
    <br><br>
    ЁЯМ╕ <i>тАЬрдЕрд▓реНрд▓рд╛рд╣ рдЖрдкрдХреЛ рдФрд░ рдЬрд╝реНрдпрд╛рджрд╛ рджреЗрдиреЗ рдХреА рддреМрдлрд╝реАрдХрд╝ рдФрд░ рдмрд░рдХрдд рдЕрддрд╛ рдХрд░реЗредтАЭ</i>
  </div>

  <form id="donationForm">
    <input type="text" name="name" placeholder="рдкреВрд░рд╛ рдирд╛рдо (Full Name)" required>
    <input type="text" name="mobile" placeholder="рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░ (Mobile Number)" required>
    <input type="number" name="amount" placeholder="рджрд╛рди рд░рд╛рд╢рд┐ тВ╣ (Amount)" required>
    <select name="mode" required>
      <option value="">рднреБрдЧрддрд╛рди рдХрд╛ рддрд░реАрдХрд╛ рдЪреБрдиреЗрдВ (Select Mode)</option>
      <option>Cash (рдирдХрдж)</option>
      <option>Online (рдСрдирд▓рд╛рдЗрди)</option>
    </select>
    <label>Upload QR Screenshot (optional)</label>
    <input type="file" id="qrFile" accept="image/*">
    
    <div class="progress-bar">
      <div class="progress" id="progress"></div>
    </div>

    <button type="submit">ЁЯХКя╕П рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ (Submit Donation)</button>
  </form>

  <h3 style="margin-top:30px;">ЁЯУЛ Donation Status / рджрд╛рди рдХреА рд╕реНрдерд┐рддрд┐</h3>
<div class="table-wrapper">
  <table id="donationTable">
    <thead><tr>
      <th>рддрд╛рд░реАрдЦ / Date</th>
      <th>рдирд╛рдо</th>
      <th>рдореЛрдмрд╛рдЗрд▓</th>
      <th>рд░рд╛рд╢рд┐ (тВ╣)</th>
      <th>Mode</th>
      <th>QR</th>
      <th>рд╕реНрдерд┐рддрд┐ (Status)</th>
    </tr></thead>
    <tbody></tbody>
  </table>
</div>



<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzGQ-g10KbYVmoo-DZlZSw3pAbfEbT-T-iCRCGFkByxnskI3ClOHiImSZkZZ8bZXz4Z6g/exec";

document.getElementById("donationForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const fd = new FormData(e.target);
  const file = document.getElementById("qrFile").files[0];
  const progressBar = document.querySelector(".progress-bar");
  const progress = document.getElementById("progress");
  
  progressBar.style.display = "block";
  progress.style.width = "10%";

  let base64 = "";
  if (file) {
    base64 = await toBase64(file, progress);
  }

  const data = {
    action: "addDonation",
    name: fd.get("name"),
    mobile: fd.get("mobile"),
    amount: fd.get("amount"),
    mode: fd.get("mode"),
    qrBase64: base64
  };

  progress.style.width = "70%";

  await fetch(SCRIPT_URL, {
    method: "POST",
    body: JSON.stringify(data),
  });

  progress.style.width = "100%";
  setTimeout(()=>{progressBar.style.display="none";},1000);

  alert("ЁЯЩП рдЖрдкрдХрд╛ рджрд╛рди рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рджрд░реНрдЬ рд╣реЛ рдЧрдпрд╛ рд╣реИ!");
  e.target.reset();
  loadDonations();
});

async function loadDonations() {
  const res = await fetch(SCRIPT_URL, {
    method: "POST",
    body: JSON.stringify({ action: "getDonations" }),
  });
  const json = await res.json();
  const tbody = document.querySelector("#donationTable tbody");
  tbody.innerHTML = "";
  json.donations.forEach(r => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${new Date(r.date).toLocaleString()}</td>
      <td>${r.name}</td>
      <td>${r.mobile}</td>
      <td>тВ╣${r.amount}</td>
      <td>${r.mode}</td>
      <td>${r.qrUrl ? `<a href="${r.qrUrl}" target="_blank"><img class="qr-thumb" src="${r.qrUrl}"></a>` : '-'}</td>
      <td style="color:${r.status=='Verified'?'green':'red'};font-weight:600">${r.status}</td>
    `;
    tbody.appendChild(tr);
  });
}

function toBase64(file, progress) {
  return new Promise((res, rej) => {
    const reader = new FileReader();
    reader.onloadstart = () => { progress.style.width = "30%"; };
    reader.onprogress = (e) => {
      if (e.lengthComputable) {
        const percent = Math.round((e.loaded / e.total) * 40) + 30;
        progress.style.width = percent + "%";
      }
    };
    reader.onloadend = () => { progress.style.width = "60%"; };
    reader.onload = () => res(reader.result);
    reader.onerror = err => rej(err);
    reader.readAsDataURL(file);
  });
}

loadDonations();
</script>
</body>
</html>
